<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>🌈 Interactive Periodic Table — Modern Chemistry Explorer</title>
<link rel="icon" href="https://img.icons8.com/color/48/periodic-table.png" type="image/png">
<meta name="description" content="A visually stunning, interactive periodic table of elements. Explore, search, quiz, and learn chemistry with modern UI.">
<style>
:root{
  --bg:linear-gradient(135deg, #eaf2ff 0%, #cfe6ff 60%, #f6eaff 100%), linear-gradient(120deg, #f0f9ff 0%, #e0e7ff 100%);
  --card:#ffffff;
  --muted:#334155;
  --text:#071028;
  --cell-size:48px; /* default compact */
  --cell-radius:8px;
  --accent:#2b6bf6;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
.header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;max-width:1200px;margin:10px auto}
.title{font-weight:800;font-size:18px}
.controls{display:flex;gap:10px;align-items:center}
/* neumorphic bulge buttons */
.btn{
  background:linear-gradient(180deg,#ffffff,#e6eefc);
  border-radius:12px;padding:8px 12px;border:1px solid rgba(43,107,246,0.12);box-shadow: 6px 6px 12px rgba(172,186,224,0.35), -6px -6px 12px rgba(255,255,255,0.9);cursor:pointer;font-weight:700;color:var(--accent)
}
.btn:active{transform:translateY(2px)}
.pill{padding:8px 10px;border-radius:999px;background:linear-gradient(180deg,#fff,#e8f0ff);border:1px solid rgba(43,107,246,0.08);box-shadow: 4px 4px 10px rgba(172,186,224,0.28);cursor:pointer}
.input{padding:8px 10px;border-radius:12px;border:1px solid rgba(15,23,42,0.06);box-shadow:inset 0 6px 14px rgba(16,24,40,0.03);min-width:220px}
.slider{width:160px}
.wrap{max-width:1200px;margin:12px auto;padding:12px}
.table-wrap{overflow:hidden}
.table{display:grid;grid-template-columns:repeat(18,var(--cell-size));grid-auto-rows:var(--cell-size);gap:6px;justify-content:center;background:transparent;padding:16px;border-radius:12px}
.cell{width:var(--cell-size);height:var(--cell-size);border-radius:var(--cell-radius);display:flex;flex-direction:column;justify-content:space-between;padding:4px;color:white;font-weight:700;cursor:pointer;transition:transform .12s,box-shadow .12s}
.cell:hover{transform:translateY(-6px);box-shadow:0 14px 30px rgba(11,20,40,0.12)}
.atomic{font-size:10px;opacity:0.95}
.symbol{font-size:14px;text-align:center}
.elname{font-size:9px;text-align:center;opacity:0.95}
/* category classes */
.alkali{background:linear-gradient(180deg,#ff7a5a,#ff5634)}
.alkaline{background:linear-gradient(180deg,#ffb84a,#ff9900)}
.transition{background:linear-gradient(180deg,#5fb3ff,#2382ff)}
.post{background:linear-gradient(180deg,#9aa4b6,#6f7f8f)}
.metalloid{background:linear-gradient(180deg,#c79b7b,#8d6149)}
.poly{background:linear-gradient(180deg,#7cd86b,#2db34a)}
.diatomic{background:linear-gradient(180deg,#6ee7ff,#0fb5d0)}
.halogen{background:linear-gradient(180deg,#64f0e6,#09b6a9)}
.noble{background:linear-gradient(180deg,#9be7ff,#3bb6ff)}
.lanth{background:linear-gradient(180deg,#d8b4ff,#a78bfa)}
.act{background:linear-gradient(180deg,#ffb3d6,#ff6da3)}
.unknown{background:linear-gradient(180deg,#cfcfcf,#9e9e9e)}
.ghost{opacity:0.65;filter:grayscale(10%)}
.f-label{grid-column:1/span 3;display:flex;align-items:center;justify-content:flex-end;padding-right:6px;color:var(--muted);font-size:12px}
/* tooltip */
.tooltip{position:fixed;z-index:90;pointer-events:none;background:linear-gradient(180deg,#0b1b34,#08223f);color:#e6f3ff;padding:8px 10px;border-radius:10px;font-size:13px;box-shadow:0 20px 60px rgba(2,8,23,0.6);opacity:0;transform:translateY(6px);transition:opacity .12s,transform .12s}
.tooltip.show{opacity:1;transform:translateY(0)}
/* modal */
dialog{border:none;border-radius:12px}
dialog::backdrop{background:rgba(2,8,23,0.55)}
.modal{background:linear-gradient(180deg,#071021,#0b1730);color:#eaf4ff;padding:18px;border-radius:12px;width:min(900px,96vw);display:grid;grid-template-columns:1fr 300px;gap:12px}
.big{font-size:56px;font-weight:900}
.meta{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:8px}
.mitem{background:rgba(255,255,255,0.03);padding:10px;border-radius:8px}
.rightbox{display:flex;flex-direction:column;gap:10px}
.legend{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:12px}
.legend .leg{display:flex;gap:8px;align-items:center;padding:6px 8px;border-radius:999px;background:linear-gradient(180deg,#fff,#f1f7ff);box-shadow:4px 6px 12px rgba(160,180,220,0.25)}
.legend .sw{width:20px;height:14px;border-radius:6px}
/* dark mode */
body.dark{ --bg:#071022; --card:#071022; --text:#e6f3ff }
body.dark .btn{ background: linear-gradient(180deg,#0b1226,#07101e); color:#bcd6ff; border:1px solid rgba(255,255,255,0.03)}
/* responsive scale rules using clamp */
@media (min-width:1400px){:root{--cell-size:clamp(44px,2.5vw,60px)}}
@media (max-width:1399px){:root{--cell-size:clamp(36px,3.5vw,52px)}}
@media (max-width:800px){:root{--cell-size:clamp(28px,4.6vw,44px)}}
</style>
</head>
<body>
  <!-- PWA manifest and service worker registration -->
  <link rel="manifest" href="manifest.json">
  <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
      navigator.serviceWorker.register('sw.js').then(function(reg) {
        // Service worker registered
      });
    });
  }
  </script>
<header class="header" style="background:var(--card);box-shadow:0 2px 16px rgba(2,8,23,0.07);border-radius:14px;margin-bottom:18px;">
  <div style="display:flex;flex-direction:column;gap:2px">
    <div class="title" style="font-size:2rem;letter-spacing:-1px;color:var(--accent);margin-bottom:2px">Interactive Periodic Table</div>
    <div style="font-size:13px;color:var(--muted)">Hover for quick info — click for full details</div>
  </div>
  <div class="controls" style="gap:18px"></div>
    <div style="display:flex;flex-direction:column;gap:8px"></div>
      <div style="display:flex;gap:8px;align-items:center"></div>
        <input id="search" class="input" placeholder="Search name, symbol or #" aria-label="search" style="font-size:15px">
        <div id="autocomplete" style="position:relative"></div>
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <button id="compactBtn" class="btn" title="Compact / Study">Compact</button>
        <input id="zoomSlider" class="slider" type="range" min="28" max="78" value="48" title="Zoom slider">
        <button id="resetBtn" class="pill">Reset View</button>
        <button id="themeToggle" class="btn" title="Toggle dark/light mode">🌗</button>
      </div>
    </div>
  </div>
</header>

<!-- Quiz UI -->
<section id="quizBox" style="max-width:500px;margin:32px auto 0;background:var(--card);border-radius:14px;box-shadow:0 8px 32px rgba(2,8,23,0.10);padding:24px;display:none">
  <div style="font-weight:700;font-size:1.3rem;margin-bottom:10px;color:var(--accent)">Periodic Table Quiz</div>
  <div style="margin-bottom:12px">
    <label for="quizMode" style="font-size:14px;font-weight:600">Select Mode:</label>
    <select id="quizMode" style="margin-left:8px;padding:6px 10px;border-radius:8px">
      <option value="easy">Easy (5 Qs, 1–20)</option>
      <option value="medium">Medium (20 Qs, 1–50)</option>
      <option value="hard">Hard (30 Qs, 1–118)</option>
      <option value="extreme">Extreme (100 Qs, 1–118)</option>
    </select>
    <button id="startQuiz" class="btn" style="margin-left:12px">Start Quiz</button>
    <button id="stopQuiz" class="pill" style="margin-left:8px;display:none">Stop Quiz</button>
  </div>
  <div id="quizArea" style="margin-top:16px"></div>
</section>
<button id="quizToggle" class="btn" style="position:fixed;bottom:24px;right:24px;z-index:99">🧪 Quiz</button>

<script>
const quizBox = document.getElementById('quizBox');
const quizToggle = document.getElementById('quizToggle');
const quizMode = document.getElementById('quizMode');
const startQuiz = document.getElementById('startQuiz');
const stopQuiz = document.getElementById('stopQuiz');
const quizArea = document.getElementById('quizArea');

let quizElements = [];
let quizIndex = 0;
let quizScore = 0;
let quizActive = false;
let quizTotal = 0;
let quizNegative = 0;

// Show/hide quiz box
quizToggle.addEventListener('click', ()=>{
  quizBox.style.display = quizBox.style.display==='none' ? 'block' : 'none';
});

// Start quiz
startQuiz.addEventListener('click', ()=>{
  let mode = quizMode.value;
  let count = 5;
  if(mode==='easy'){ quizElements = ELEMENTS.slice(0,20); count=5; quizNegative=0.25; }
  else if(mode==='medium'){ quizElements = ELEMENTS.slice(0,50); count=20; quizNegative=0.5; }
  else if(mode==='hard'){ quizElements = ELEMENTS.slice(0,118); count=30; quizNegative=1; }
  else { quizElements = ELEMENTS.slice(0,118); count=100; quizNegative=2; }
  quizElements = quizElements.sort(()=>Math.random()-0.5).slice(0,count); // shuffle and pick count
  quizIndex = 0;
  quizScore = 0;
  quizTotal = count;
  quizActive = true;
  stopQuiz.style.display = 'inline-block';
  showQuizQuestion();
});

// Stop quiz mid-way
stopQuiz.addEventListener('click', ()=>{
  quizActive = false;
  quizArea.innerHTML = `<div style="font-size:16px;font-weight:700;margin-bottom:8px">Quiz Stopped!</div>
    <div>Your score: <strong>${quizScore} / ${quizTotal}</strong></div>
    <div>Questions attempted: <strong>${quizIndex}</strong></div>
    <button class="btn" id="quizRestart" style="margin-top:12px">Restart</button>`;
  stopQuiz.style.display = 'none';
  document.getElementById('quizRestart').onclick = ()=>{ startQuiz.click(); };
});

// Show question
function showQuizQuestion(){
  if(!quizActive || quizIndex >= quizElements.length){
    quizArea.innerHTML = `<div style="font-size:16px;font-weight:700;margin-bottom:8px">Quiz Complete!</div>
      <div>Your score: <strong>${quizScore} / ${quizTotal}</strong></div>
      <button class="btn" id="quizRestart" style="margin-top:12px">Restart</button>`;
    stopQuiz.style.display = 'none';
    document.getElementById('quizRestart').onclick = ()=>{ startQuiz.click(); };
    quizActive = false;
    return;
  }
  const el = quizElements[quizIndex];
  const qType = Math.random()<0.5 ? 'name' : 'symbol';
  let question, answer;
  if(qType==='name'){
    question = `What is the symbol for <strong>${el.name}</strong>?`;
    answer = el.sym;
  }else{
    question = `What is the name of the element with symbol <strong>${el.sym}</strong>?`;
    answer = el.name;
  }
  quizArea.innerHTML = `
    <div style="font-size:15px;margin-bottom:10px">${question}</div>
    <input id="quizInput" class="input" placeholder="Your answer" autocomplete="off" style="width:70%">
    <button id="quizSubmit" class="btn" style="margin-left:10px">Submit</button>
    <div id="quizFeedback" style="margin-top:10px;font-size:13px"></div>
    <div style="margin-top:14px;color:var(--muted);font-size:13px">Question ${quizIndex+1} of ${quizTotal} | Score: ${quizScore}</div>
    <div style="margin-top:4px;color:#f87171;font-size:12px">Negative marking: -${quizNegative} for wrong answer</div>
  `;
  document.getElementById('quizSubmit').onclick = ()=>{
    const val = document.getElementById('quizInput').value.trim();
    const correct = val.toLowerCase() === answer.toLowerCase();
    const feedback = document.getElementById('quizFeedback');
    if(correct){
      feedback.textContent = '✅ Correct!';
      quizScore++;
    }else{
      feedback.textContent = `❌ Incorrect. Correct answer: ${answer} (-${quizNegative})`;
      quizScore -= quizNegative;
      if(quizScore<0) quizScore=0;
    }
    setTimeout(()=>{ quizIndex++; showQuizQuestion(); }, 900);
  };
  document.getElementById('quizInput').addEventListener('keydown', function(e){
    if(e.key==='Enter') document.getElementById('quizSubmit').click();
  });
}
</script>

<!-- Login/Sign Up Interface (hidden by default) -->
<section id="loginBox" style="max-width:400px;margin:32px auto;background:var(--card);border-radius:14px;box-shadow:0 8px 32px rgba(2,8,23,0.10);padding:24px;display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:100;">
  <div style="font-weight:700;font-size:1.2rem;margin-bottom:10px;color:var(--accent)">Login / Sign Up</div>
  <form id="loginForm" autocomplete="off">
    <div style="margin-bottom:12px">
      <label for="username" style="font-size:14px;font-weight:600">Username:</label>
      <input id="username" name="username" class="input" required style="width:100%;margin-top:6px">
    </div>
    <div style="margin-bottom:16px">
      <label for="password" style="font-size:14px;font-weight:600">Password:</label>
      <input id="password" name="password" type="password" class="input" required style="width:100%;margin-top:6px">
    </div>
    <button type="submit" class="btn" style="width:100%">Login</button>
    <button type="button" id="signupBtn" class="pill" style="width:100%;margin-top:8px">Sign Up</button>
    <div id="loginFeedback" style="margin-top:10px;font-size:13px;color:#f87171"></div>
  </form>
</section>
<button id="loginToggle" class="btn" style="position:fixed;bottom:24px;right:156px;z-index:99">🔐 Login/Sign Up</button>
<script>
// User storage using localStorage
const loginForm = document.getElementById('loginForm');
const loginBox = document.getElementById('loginBox');
const loginFeedback = document.getElementById('loginFeedback');
const signupBtn = document.getElementById('signupBtn');
const loginToggle = document.getElementById('loginToggle');

function getUsers() {
  return JSON.parse(localStorage.getItem('users') || '{}');
}
function saveUser(username, password) {
  const users = getUsers();
  users[username] = password;
  localStorage.setItem('users', JSON.stringify(users));
}
function checkUser(username, password) {
  const users = getUsers();
  return users[username] && users[username] === password;
}
function setLoggedIn(username) {
  localStorage.setItem('loginData', JSON.stringify({ username }));
}
function getLoggedInUser() {
  const data = localStorage.getItem('loginData');
  return data ? JSON.parse(data).username : null;
}
function isLoggedIn() {
  return !!getLoggedInUser();
}
function showLoginBox(show) {
  loginBox.style.display = show ? 'block' : 'none';
}
loginToggle.addEventListener('click', () => {
  showLoginBox(loginBox.style.display === 'none');
});
function logout() {
  localStorage.removeItem('loginData');
  showLoginBox(true);
}
if (isLoggedIn()) {
  showLoginBox(false);
} else {
  showLoginBox(false); // hidden by default, shown on button click
}
loginForm.addEventListener('submit', function(e) {
  e.preventDefault();
  const username = loginForm.username.value.trim();
  const password = loginForm.password.value;
  if (username && password) {
    if (checkUser(username, password)) {
      setLoggedIn(username);
      loginFeedback.textContent = '';
      showLoginBox(false);
    } else {
      loginFeedback.textContent = 'Invalid username or password.';
    }
  } else {
    loginFeedback.textContent = 'Please enter both username and password.';
  }
});
signupBtn.addEventListener('click', function() {
  const username = loginForm.username.value.trim();
  const password = loginForm.password.value;
  if (username && password) {
    const users = getUsers();
    if (users[username]) {
      loginFeedback.textContent = 'User already exists. Please login.';
    } else {
      saveUser(username, password);
      setLoggedIn(username);
      loginFeedback.textContent = '';
      showLoginBox(false);
    }
  } else {
    loginFeedback.textContent = 'Please enter both username and password.';
  }
});
</script>

<!-- Shortcut UI (hidden by default) -->
<button id="helpBtn" class="btn" style="position:fixed;bottom:24px;right:90px;z-index:99">❔ Help</button>
<section id="shortcutBox" style="max-width:400px;margin:24px auto 0;background:var(--card);border-radius:14px;box-shadow:0 8px 32px rgba(2,8,23,0.10);padding:18px;display:none">
  <div style="font-weight:700;font-size:1.1rem;margin-bottom:8px;color:var(--accent)">Keyboard Shortcuts</div>
  <ul style="font-size:13px;line-height:1.7;margin:0;padding-left:18px">
    <li><strong>/</strong> — Focus search box</li>
    <li><strong>Esc</strong> — Close modal or autocomplete</li>
    <li><strong>Ctrl+Q</strong> — Toggle Quiz UI</li>
    <li><strong>Ctrl+L</strong> — Toggle Login UI</li>
    <li><strong>Ctrl+T</strong> — Toggle Theme</li>
    <li><strong>Ctrl+R</strong> — Reset view</li>
  </ul>
</section>
<script>
// Show/hide shortcut box when help button is clicked
const helpBtn = document.getElementById('helpBtn');
const shortcutBox = document.getElementById('shortcutBox');
helpBtn.addEventListener('click', () => {
  shortcutBox.style.display = shortcutBox.style.display === 'none' ? 'block' : 'none';
});

// Shortcut logic
document.addEventListener('keydown', function(e) {
  // Focus search
  if (e.key === '/' && document.activeElement !== SEARCH) {
    e.preventDefault();
    SEARCH.focus();
  }
  // Close modal/autocomplete/shortcut box
  if (e.key === 'Escape') {
    if (MODAL.open) MODAL.close();
    AUTOCLOSE();
    shortcutBox.style.display = 'none';
  }
  // Toggle Quiz UI
  if (e.ctrlKey && e.key.toLowerCase() === 'q') {
    e.preventDefault();
    quizToggle.click();
  }
  // Toggle Login UI
  if (e.ctrlKey && e.key.toLowerCase() === 'l') {
    e.preventDefault();
    showLoginBox(loginBox.style.display === 'none');
  }
  // Toggle Theme
  if (e.ctrlKey && e.key.toLowerCase() === 't') {
    e.preventDefault();
    THEME.click();
  }
  // Reset View
  if (e.ctrlKey && e.key.toLowerCase() === 'r') {
    e.preventDefault();
    RESET.click();
  }
});
</script>

<div class="wrap">
  <div class="table-wrap">
    <div id="table" class="table"></div>
  </div>
  <div class="legend" id="legend"></div>
</div>

<div id="tooltip" class="tooltip" aria-hidden="true"></div>

<dialog id="modal">
  <div class="modal">
    <div>
      <div style="display:flex;align-items:center;gap:12px">
        <div class="big" id="mSym">H</div>
        <div>
          <div style="font-size:20px;font-weight:800" id="mName">Hydrogen</div>
          <div style="color:#bcd6ff;font-size:13px" id="mSub">Atomic #1</div>
        </div>
      </div>
      <div style="margin-top:8px;color:#cfe6ff" id="mAbout">—</div>
      <div class="meta">
        <div class="mitem">Atomic mass<br><strong id="mMass">1.008</strong></div>
        <div class="mitem">Electron config<br><strong id="mConfig">1s1</strong></div>
        <div class="mitem">Period / Group<br><strong id="mPG">1 / 1</strong></div>
        <div class="mitem">State @ STP<br><strong id="mState">gas</strong></div>
      </div>
    </div>
    <div class="rightbox">
      <div class="mitem">Quick facts<br><strong id="mQuick">—</strong></div>
      <div class="mitem">Category<br><strong id="mCat">—</strong></div>
      <div style="margin-top:auto"><button id="closeModal" class="btn" style="width:100%">Close</button></div>
    </div>
  </div>
</dialog>

<script>
/* ELEMENT DATA (118 elements) */
const ELEMENTS = [
{"n":1,"sym":"H","name":"Hydrogen","cat":"diatomic","mass":"1.008","state":"gas","group":1,"period":1,"config":"1s¹","about":"Lightest element; common in stars and fuels."},
{"n":2,"sym":"He","name":"Helium","cat":"noble","mass":"4.0026","state":"gas","group":18,"period":1,"config":"1s²","about":"Inert gas; cryogenics and balloons."},
{"n":3,"sym":"Li","name":"Lithium","cat":"alkali","mass":"6.94","state":"solid","group":1,"period":2,"config":"[He] 2s¹","about":"Used in batteries; soft metal."},
{"n":4,"sym":"Be","name":"Beryllium","cat":"alkaline","mass":"9.0122","state":"solid","group":2,"period":2,"config":"[He] 2s²","about":"Light, stiff metal used in aerospace."},
{"n":5,"sym":"B","name":"Boron","cat":"metalloid","mass":"10.81","state":"solid","group":13,"period":2,"config":"[He] 2s² 2p¹","about":"Borosilicate glass and detergents."},
{"n":6,"sym":"C","name":"Carbon","cat":"poly","mass":"12.011","state":"solid","group":14,"period":2,"config":"[He] 2s² 2p²","about":"Basis of organic chemistry; graphite & diamond."},
{"n":7,"sym":"N","name":"Nitrogen","cat":"diatomic","mass":"14.007","state":"gas","group":15,"period":2,"config":"[He] 2s² 2p³","about":"Major component of air."},
{"n":8,"sym":"O","name":"Oxygen","cat":"diatomic","mass":"15.999","state":"gas","group":16,"period":2,"config":"[He] 2s² 2p⁴","about":"Essential for respiration."},
{"n":9,"sym":"F","name":"Fluorine","cat":"halogen","mass":"18.998","state":"gas","group":17,"period":2,"config":"[He] 2s² 2p⁵","about":"Very reactive halogen."},
{"n":10,"sym":"Ne","name":"Neon","cat":"noble","mass":"20.180","state":"gas","group":18,"period":2,"config":"[He] 2s² 2p⁶","about":"Neon signs; inert gas."},
{"n":11,"sym":"Na","name":"Sodium","cat":"alkali","mass":"22.990","state":"solid","group":1,"period":3,"config":"[Ne] 3s¹","about":"Common in salts; reactive metal."},
{"n":12,"sym":"Mg","name":"Magnesium","cat":"alkaline","mass":"24.305","state":"solid","group":2,"period":3,"config":"[Ne] 3s²","about":"Light structural metal; chlorophyll."},
{"n":13,"sym":"Al","name":"Aluminium","cat":"post","mass":"26.982","state":"solid","group":13,"period":3,"config":"[Ne] 3s² 3p¹","about":"Abundant, corrosion-resistant metal."},
{"n":14,"sym":"Si","name":"Silicon","cat":"metalloid","mass":"28.085","state":"solid","group":14,"period":3,"config":"[Ne] 3s² 3p²","about":"Semiconductor; electronics."},
{"n":15,"sym":"P","name":"Phosphorus","cat":"poly","mass":"30.974","state":"solid","group":15,"period":3,"config":"[Ne] 3s² 3p³","about":"Vital nutrient; fertilizers."},
{"n":16,"sym":"S","name":"Sulfur","cat":"poly","mass":"32.06","state":"solid","group":16,"period":3,"config":"[Ne] 3s² 3p⁴","about":"Industrial sulfuric acid."},
{"n":17,"sym":"Cl","name":"Chlorine","cat":"halogen","mass":"35.45","state":"gas","group":17,"period":3,"config":"[Ne] 3s² 3p⁵","about":"Disinfectant; forms salts."},
{"n":18,"sym":"Ar","name":"Argon","cat":"noble","mass":"39.948","state":"gas","group":18,"period":3,"config":"[Ne] 3s² 3p⁶","about":"Shielding gas in welding."},
{"n":19,"sym":"K","name":"Potassium","cat":"alkali","mass":"39.098","state":"solid","group":1,"period":4,"config":"[Ar] 4s¹","about":"Essential nutrient."},
{"n":20,"sym":"Ca","name":"Calcium","cat":"alkaline","mass":"40.078","state":"solid","group":2,"period":4,"config":"[Ar] 4s²","about":"Bones, shells; cement."},
{"n":21,"sym":"Sc","name":"Scandium","cat":"transition","mass":"44.956","state":"solid","group":3,"period":4,"config":"[Ar] 3d¹ 4s²","about":"Light transition metal."},
{"n":22,"sym":"Ti","name":"Titanium","cat":"transition","mass":"47.867","state":"solid","group":4,"period":4,"config":"[Ar] 3d² 4s²","about":"Strong, light; aerospace."},
{"n":23,"sym":"V","name":"Vanadium","cat":"transition","mass":"50.942","state":"solid","group":5,"period":4,"config":"[Ar] 3d³ 4s²","about":"Steel additive."},
{"n":24,"sym":"Cr","name":"Chromium","cat":"transition","mass":"51.996","state":"solid","group":6,"period":4,"config":"[Ar] 3d⁵ 4s¹","about":"Stainless steel; plating."},
{"n":25,"sym":"Mn","name":"Manganese","cat":"transition","mass":"54.938","state":"solid","group":7,"period":4,"config":"[Ar] 3d⁵ 4s²","about":"Steelmaking; enzymes."},
{"n":26,"sym":"Fe","name":"Iron","cat":"transition","mass":"55.845","state":"solid","group":8,"period":4,"config":"[Ar] 3d⁶ 4s²","about":"Structural metal; hemoglobin."},
{"n":27,"sym":"Co","name":"Cobalt","cat":"transition","mass":"58.933","state":"solid","group":9,"period":4,"config":"[Ar] 3d⁷ 4s²","about":"Magnets, batteries."},
{"n":28,"sym":"Ni","name":"Nickel","cat":"transition","mass":"58.693","state":"solid","group":10,"period":4,"config":"[Ar] 3d⁸ 4s²","about":"Alloys; plating."},
{"n":29,"sym":"Cu","name":"Copper","cat":"transition","mass":"63.546","state":"solid","group":11,"period":4,"config":"[Ar] 3d¹⁰ 4s¹","about":"Wiring; coins."},
{"n":30,"sym":"Zn","name":"Zinc","cat":"transition","mass":"65.38","state":"solid","group":12,"period":4,"config":"[Ar] 3d¹⁰ 4s²","about":"Galvanization."},
{"n":31,"sym":"Ga","name":"Gallium","cat":"post","mass":"69.723","state":"solid","group":13,"period":4,"config":"[Ar] 3d¹⁰ 4s² 4p¹","about":"Melts in hand; semiconductors."},
{"n":32,"sym":"Ge","name":"Germanium","cat":"metalloid","mass":"72.630","state":"solid","group":14,"period":4,"config":"[Ar] 3d¹⁰ 4s² 4p²","about":"Early semiconductor."},
{"n":33,"sym":"As","name":"Arsenic","cat":"metalloid","mass":"74.922","state":"solid","group":15,"period":4,"config":"[Ar] 3d¹⁰ 4s² 4p³","about":"Toxic compounds."},
{"n":34,"sym":"Se","name":"Selenium","cat":"poly","mass":"78.971","state":"solid","group":16,"period":4,"config":"[Ar] 3d¹⁰ 4s² 4p⁴","about":"Electronics; glass."},
{"n":35,"sym":"Br","name":"Bromine","cat":"halogen","mass":"79.904","state":"liquid","group":17,"period":4,"config":"[Ar] 3d¹⁰ 4s² 4p⁵","about":"Liquid halogen."},
{"n":36,"sym":"Kr","name":"Krypton","cat":"noble","mass":"83.798","state":"gas","group":18,"period":4,"config":"[Ar] 3d¹⁰ 4s² 4p⁶","about":"Lighting; inert gas."},
{"n":37,"sym":"Rb","name":"Rubidium","cat":"alkali","mass":"85.468","state":"solid","group":1,"period":5,"config":"[Kr] 5s¹","about":"Highly reactive alkali metal."},
{"n":38,"sym":"Sr","name":"Strontium","cat":"alkaline","mass":"87.62","state":"solid","group":2,"period":5,"config":"[Kr] 5s²","about":"Fireworks; magnets."},
{"n":39,"sym":"Y","name":"Yttrium","cat":"transition","mass":"88.906","state":"solid","group":3,"period":5,"config":"[Kr] 4d¹ 5s²","about":"LED phosphors."},
{"n":40,"sym":"Zr","name":"Zirconium","cat":"transition","mass":"91.224","state":"solid","group":4,"period":5,"config":"[Kr] 4d² 5s²","about":"Nuclear cladding."},
{"n":41,"sym":"Nb","name":"Niobium","cat":"transition","mass":"92.906","state":"solid","group":5,"period":5,"config":"[Kr] 4d⁴ 5s¹","about":"Superconducting alloys."},
{"n":42,"sym":"Mo","name":"Molybdenum","cat":"transition","mass":"95.95","state":"solid","group":6,"period":5,"config":"[Kr] 4d⁵ 5s¹","about":"Alloying element."},
{"n":43,"sym":"Tc","name":"Technetium","cat":"transition","mass":"98","state":"solid","group":7,"period":5,"config":"[Kr] 4d⁵ 5s²","about":"First artificial element."},
{"n":44,"sym":"Ru","name":"Ruthenium","cat":"transition","mass":"101.07","state":"solid","group":8,"period":5,"config":"[Kr] 4d⁷ 5s¹","about":"Catalysis; electronics."},
{"n":45,"sym":"Rh","name":"Rhodium","cat":"transition","mass":"102.91","state":"solid","group":9,"period":5,"config":"[Kr] 4d⁸ 5s¹","about":"Catalytic converters."},
{"n":46,"sym":"Pd","name":"Palladium","cat":"transition","mass":"106.42","state":"solid","group":10,"period":5,"config":"[Kr] 4d¹⁰","about":"Catalysis; hydrogen storage."},
{"n":47,"sym":"Ag","name":"Silver","cat":"transition","mass":"107.87","state":"solid","group":11,"period":5,"config":"[Kr] 4d¹⁰ 5s¹","about":"Best conductor."},
{"n":48,"sym":"Cd","name":"Cadmium","cat":"transition","mass":"112.41","state":"solid","group":12,"period":5,"config":"[Kr] 4d¹⁰ 5s²","about":"Batteries; toxic."},
{"n":49,"sym":"In","name":"Indium","cat":"post","mass":"114.82","state":"solid","group":13,"period":5,"config":"[Kr] 4d¹⁰ 5s² 5p¹","about":"ITO coatings."},
{"n":50,"sym":"Sn","name":"Tin","cat":"post","mass":"118.71","state":"solid","group":14,"period":5,"config":"[Kr] 4d¹⁰ 5s² 5p²","about":"Solder; alloys."},
{"n":51,"sym":"Sb","name":"Antimony","cat":"metalloid","mass":"121.76","state":"solid","group":15,"period":5,"config":"[Kr] 4d¹⁰ 5s² 5p³","about":"Flame retardants."},
{"n":52,"sym":"Te","name":"Tellurium","cat":"metalloid","mass":"127.60","state":"solid","group":16,"period":5,"config":"[Kr] 4d¹⁰ 5s² 5p⁴","about":"Thermoelectrics."},
{"n":53,"sym":"I","name":"Iodine","cat":"halogen","mass":"126.90","state":"solid","group":17,"period":5,"config":"[Kr] 4d¹⁰ 5s² 5p⁵","about":"Essential micronutrient."},
{"n":54,"sym":"Xe","name":"Xenon","cat":"noble","mass":"131.29","state":"gas","group":18,"period":5,"config":"[Kr] 4d¹⁰ 5s² 5p⁶","about":"Lighting; anesthesia."},
{"n":55,"sym":"Cs","name":"Caesium","cat":"alkali","mass":"132.91","state":"solid","group":1,"period":6,"config":"[Xe] 6s¹","about":"Atomic clocks."},
{"n":56,"sym":"Ba","name":"Barium","cat":"alkaline","mass":"137.33","state":"solid","group":2,"period":6,"config":"[Xe] 6s²","about":"Contrast agents; fireworks."},
{"n":57,"sym":"La","name":"Lanthanum","cat":"lanth","mass":"138.91","state":"solid","group":3,"period":6,"config":"[Xe] 5d¹ 6s²","about":"Start of lanthanides."},
{"n":58,"sym":"Ce","name":"Cerium","cat":"lanth","mass":"140.12","state":"solid","group":4,"period":8,"config":"[Xe] 4f¹ 5d¹ 6s²","about":"Catalysts; flints."},
{"n":59,"sym":"Pr","name":"Praseodymium","cat":"lanth","mass":"140.91","state":"solid","group":5,"period":8,"config":"[Xe] 4f³ 6s²","about":"Magnets; glass coloring."},
{"n":60,"sym":"Nd","name":"Neodymium","cat":"lanth","mass":"144.24","state":"solid","group":6,"period":8,"config":"[Xe] 4f⁴ 6s²","about":"Powerful magnets."},
{"n":61,"sym":"Pm","name":"Promethium","cat":"lanth","mass":"145","state":"solid","group":7,"period":8,"config":"[Xe] 4f⁵ 6s²","about":"Radioactive; rare."},
{"n":62,"sym":"Sm","name":"Samarium","cat":"lanth","mass":"150.36","state":"solid","group":8,"period":8,"config":"[Xe] 4f⁶ 6s²","about":"Magnets; neutron capture."},
{"n":63,"sym":"Eu","name":"Europium","cat":"lanth","mass":"151.96","state":"solid","group":9,"period":8,"config":"[Xe] 4f⁷ 6s²","about":"Red phosphors."},
{"n":64,"sym":"Gd","name":"Gadolinium","cat":"lanth","mass":"157.25","state":"solid","group":10,"period":8,"config":"[Xe] 4f⁷ 5d¹ 6s²","about":"MRI contrast."},
{"n":65,"sym":"Tb","name":"Terbium","cat":"lanth","mass":"158.93","state":"solid","group":11,"period":8,"config":"[Xe] 4f⁹ 6s²","about":"Green phosphors."},
{"n":66,"sym":"Dy","name":"Dysprosium","cat":"lanth","mass":"162.50","state":"solid","group":12,"period":8,"config":"[Xe] 4f¹⁰ 6s²","about":"High-temperature magnets."},
{"n":67,"sym":"Ho","name":"Holmium","cat":"lanth","mass":"164.93","state":"solid","group":13,"period":8,"config":"[Xe] 4f¹¹ 6s²","about":"Strong magnetic properties."},
{"n":68,"sym":"Er","name":"Erbium","cat":"lanth","mass":"167.26","state":"solid","group":14,"period":8,"config":"[Xe] 4f¹² 6s²","about":"Fiber amplifiers."},
{"n":69,"sym":"Tm","name":"Thulium","cat":"lanth","mass":"168.93","state":"solid","group":15,"period":8,"config":"[Xe] 4f¹³ 6s²","about":"Portable X-ray sources."},
{"n":70,"sym":"Yb","name":"Ytterbium","cat":"lanth","mass":"173.05","state":"solid","group":16,"period":8,"config":"[Xe] 4f¹⁴ 6s²","about":"Lasers; frequency standards."},
{"n":71,"sym":"Lu","name":"Lutetium","cat":"lanth","mass":"174.97","state":"solid","group":17,"period":8,"config":"[Xe] 4f¹⁴ 5d¹ 6s²","about":"Catalysts; PET scanners."},
{"n":72,"sym":"Hf","name":"Hafnium","cat":"transition","mass":"178.49","state":"solid","group":4,"period":6,"config":"[Xe] 4f¹⁴ 5d² 6s²","about":"High melting point; nuclear control."},
{"n":73,"sym":"Ta","name":"Tantalum","cat":"transition","mass":"180.95","state":"solid","group":5,"period":6,"config":"[Xe] 4f¹⁴ 5d³ 6s²","about":"Capacitors; corrosion resistant."},
{"n":74,"sym":"W","name":"Tungsten","cat":"transition","mass":"183.84","state":"solid","group":6,"period":6,"config":"[Xe] 4f¹⁴ 5d⁴ 6s²","about":"Very high melting point."},
{"n":75,"sym":"Re","name":"Rhenium","cat":"transition","mass":"186.21","state":"solid","group":7,"period":6,"config":"[Xe] 4f¹⁴ 5d⁵ 6s²","about":"Superalloys."},
{"n":76,"sym":"Os","name":"Osmium","cat":"transition","mass":"190.23","state":"solid","group":8,"period":6,"config":"[Xe] 4f¹⁴ 5d⁶ 6s²","about":"Very dense metal."},
{"n":77,"sym":"Ir","name":"Iridium","cat":"transition","mass":"192.22","state":"solid","group":9,"period":6,"config":"[Xe] 4f¹⁴ 5d⁷ 6s²","about":"Corrosion-resistant."},
{"n":78,"sym":"Pt","name":"Platinum","cat":"transition","mass":"195.08","state":"solid","group":10,"period":6,"config":"[Xe] 4f¹⁴ 5d⁹ 6s¹","about":"Catalysts; jewelry."},
{"n":79,"sym":"Au","name":"Gold","cat":"transition","mass":"196.97","state":"solid","group":11,"period":6,"config":"[Xe] 4f¹⁴ 5d¹⁰ 6s¹","about":"Noble metal; coins, jewelry."},
{"n":80,"sym":"Hg","name":"Mercury","cat":"transition","mass":"200.59","state":"liquid","group":12,"period":6,"config":"[Xe] 4f¹⁴ 5d¹⁰ 6s²","about":"Liquid at room temperature."},
{"n":81,"sym":"Tl","name":"Thallium","cat":"post","mass":"204.38","state":"solid","group":13,"period":6,"config":"[Xe] 4f¹⁴ 5d¹⁰ 6s² 6p¹","about":"Toxic; electronics."},
{"n":82,"sym":"Pb","name":"Lead","cat":"post","mass":"207.2","state":"solid","group":14,"period":6,"config":"[Xe] 4f¹⁴ 5d¹⁰ 6s² 6p²","about":"Shielding; toxic."},
{"n":83,"sym":"Bi","name":"Bismuth","cat":"post","mass":"208.98","state":"solid","group":15,"period":6,"config":"[Xe] 4f¹⁴ 5d¹⁰ 6s² 6p³","about":"Low-toxicity lead alternative."},
{"n":84,"sym":"Po","name":"Polonium","cat":"post","mass":"209","state":"solid","group":16,"period":6,"config":"[Xe] 4f¹⁴ 5d¹⁰ 6s² 6p⁴","about":"Radioactive."},
{"n":85,"sym":"At","name":"Astatine","cat":"halogen","mass":"210","state":"solid","group":17,"period":6,"config":"[Xe] 4f¹⁴ 5d¹⁰ 6s² 6p⁵","about":"Rare, radioactive halogen."},
{"n":86,"sym":"Rn","name":"Radon","cat":"noble","mass":"222","state":"gas","group":18,"period":6,"config":"[Xe] 4f¹⁴ 5d¹⁰ 6s² 6p⁶","about":"Radioactive noble gas."},
{"n":87,"sym":"Fr","name":"Francium","cat":"alkali","mass":"223","state":"solid","group":1,"period":7,"config":"[Rn] 7s¹","about":"Extremely rare, radioactive."},
{"n":88,"sym":"Ra","name":"Radium","cat":"alkaline","mass":"226","state":"solid","group":2,"period":7,"config":"[Rn] 7s²","about":"Radioactive."},
{"n":89,"sym":"Ac","name":"Actinium","cat":"act","mass":"227","state":"solid","group":3,"period":7,"config":"[Rn] 6d¹ 7s²","about":"Start of actinides."},
{"n":90,"sym":"Th","name":"Thorium","cat":"act","mass":"232.04","state":"solid","group":4,"period":9,"config":"[Rn] 6d² 7s²","about":"Potential nuclear fuel."},
{"n":91,"sym":"Pa","name":"Protactinium","cat":"act","mass":"231.04","state":"solid","group":5,"period":9,"config":"[Rn] 5f² 6d¹ 7s²","about":"Rare, radioactive."},
{"n":92,"sym":"U","name":"Uranium","cat":"act","mass":"238.03","state":"solid","group":6,"period":9,"config":"[Rn] 5f³ 6d¹ 7s²","about":"Nuclear fuel."},
{"n":93,"sym":"Np","name":"Neptunium","cat":"act","mass":"237","state":"solid","group":7,"period":9,"config":"[Rn] 5f⁴ 6d¹ 7s²","about":"Synthetic; radioactive."},
{"n":94,"sym":"Pu","name":"Plutonium","cat":"act","mass":"244","state":"solid","group":8,"period":9,"config":"[Rn] 5f⁶ 7s²","about":"Nuclear fuel; weapons."},
{"n":95,"sym":"Am","name":"Americium","cat":"act","mass":"243","state":"solid","group":9,"period":9,"config":"[Rn] 5f⁷ 7s²","about":"Smoke detectors (Am-241)."},
{"n":96,"sym":"Cm","name":"Curium","cat":"act","mass":"247","state":"solid","group":10,"period":9,"config":"[Rn] 5f⁷ 6d¹ 7s²","about":"Synthetic element."},
{"n":97,"sym":"Bk","name":"Berkelium","cat":"act","mass":"247","state":"solid","group":11,"period":9,"config":"[Rn] 5f⁹ 7s²","about":"Rare synthetic."},
{"n":98,"sym":"Cf","name":"Californium","cat":"act","mass":"251","state":"solid","group":12,"period":9,"config":"[Rn] 5f¹⁰ 7s²","about":"Neutron emitter."},
{"n":99,"sym":"Es","name":"Einsteinium","cat":"act","mass":"252","state":"solid","group":13,"period":9,"config":"[Rn] 5f¹¹ 7s²","about":"Discovered in H-bomb debris."},
{"n":100,"sym":"Fm","name":"Fermium","cat":"act","mass":"257","state":"solid","group":14,"period":9,"config":"[Rn] 5f¹² 7s²","about":"Short half-lives."},
{"n":101,"sym":"Md","name":"Mendelevium","cat":"act","mass":"258","state":"solid","group":15,"period":9,"config":"[Rn] 5f¹³ 7s²","about":"Named after Mendeleev."},
{"n":102,"sym":"No","name":"Nobelium","cat":"act","mass":"259","state":"solid","group":16,"period":9,"config":"[Rn] 5f¹⁴ 7s²","about":"Synthetic."},
{"n":103,"sym":"Lr","name":"Lawrencium","cat":"act","mass":"266","state":"solid","group":17,"period":9,"config":"[Rn] 5f¹⁴ 7s² 7p¹","about":"End of actinides."},
{"n":104,"sym":"Rf","name":"Rutherfordium","cat":"transition","mass":"267","state":"unknown","group":4,"period":7,"config":"[Rn] 5f¹⁴ 6d² 7s²","about":"Synthetic."},
{"n":105,"sym":"Db","name":"Dubnium","cat":"transition","mass":"268","state":"unknown","group":5,"period":7,"config":"[Rn] 5f¹⁴ 6d³ 7s²","about":"Synthetic."},
{"n":106,"sym":"Sg","name":"Seaborgium","cat":"transition","mass":"269","state":"unknown","group":6,"period":7,"config":"[Rn] 5f¹⁴ 6d⁴ 7s²","about":"Synthetic."},
{"n":107,"sym":"Bh","name":"Bohrium","cat":"transition","mass":"270","state":"unknown","group":7,"period":7,"config":"[Rn] 5f¹⁴ 6d⁵ 7s²","about":"Synthetic."},
{"n":108,"sym":"Hs","name":"Hassium","cat":"transition","mass":"269","state":"unknown","group":8,"period":7,"config":"[Rn] 5f¹⁴ 6d⁶ 7s²","about":"Synthetic."},
{"n":109,"sym":"Mt","name":"Meitnerium","cat":"unknown","mass":"278","state":"unknown","group":9,"period":7,"config":"[Rn] 5f¹⁴ 6d⁷ 7s²","about":"Synthetic."},
{"n":110,"sym":"Ds","name":"Darmstadtium","cat":"unknown","mass":"281","state":"unknown","group":10,"period":7,"config":"[Rn] 5f¹⁴ 6d⁸ 7s²","about":"Synthetic."},
{"n":111,"sym":"Rg","name":"Roentgenium","cat":"unknown","mass":"282","state":"unknown","group":11,"period":7,"config":"[Rn] 5f¹⁴ 6d⁹ 7s²","about":"Synthetic."},
{"n":112,"sym":"Cn","name":"Copernicium","cat":"transition","mass":"285","state":"unknown","group":12,"period":7,"config":"[Rn] 5f¹⁴ 6d¹⁰ 7s²","about":"Synthetic."},
{"n":113,"sym":"Nh","name":"Nihonium","cat":"unknown","mass":"286","state":"unknown","group":13,"period":7,"config":"[Rn] 5f¹⁴ 6d¹⁰ 7s² 7p¹","about":"Named after Japan."},
{"n":114,"sym":"Fl","name":"Flerovium","cat":"unknown","mass":"289","state":"unknown","group":14,"period":7,"config":"[Rn] 5f¹⁴ 6d¹⁰ 7s² 7p²","about":"Synthetic."},
{"n":115,"sym":"Mc","name":"Moscovium","cat":"unknown","mass":"289","state":"unknown","group":15,"period":7,"config":"[Rn] 5f¹⁴ 6d¹⁰ 7s² 7p³","about":"Synthetic."},
{"n":116,"sym":"Lv","name":"Livermorium","cat":"unknown","mass":"293","state":"unknown","group":16,"period":7,"config":"[Rn] 5f¹⁴ 6d¹⁰ 7s² 7p⁴","about":"Synthetic."},
{"n":117,"sym":"Ts","name":"Tennessine","cat":"unknown","mass":"294","state":"unknown","group":17,"period":7,"config":"[Rn] 5f¹⁴ 6d¹⁰ 7s² 7p⁵","about":"Synthetic."},
{"n":118,"sym":"Og","name":"Oganesson","cat":"unknown","mass":"294","state":"unknown","group":18,"period":7,"config":"[Rn] 5f¹⁴ 6d¹⁰ 7s² 7p⁶","about":"Heaviest known element."}
];
/* Speech Synthesis UI */
function speakElement(el) {
  if (!('speechSynthesis' in window)) return;
  const info = [
    `Element ${el.name}, symbol ${el.sym}, atomic number ${el.n}.`,
    `Category: ${CATMAP[el.cat] || el.cat}.`,
    `Atomic mass: ${el.mass}.`,
    `Electron configuration: ${el.config || 'unknown'}.`,
    `Period: ${el.period}, Group: ${el.group}.`,
    `State at standard temperature and pressure: ${el.state || 'unknown'}.`,
    el.about ? `About: ${el.about}` : ''
  ].join(' ');
  const utter = new SpeechSynthesisUtterance(info);
  utter.rate = 1;
  utter.pitch = 1;
  window.speechSynthesis.cancel();
  window.speechSynthesis.speak(utter);
}

// Add speak button to modal
const speakBtn = document.createElement('button');
speakBtn.textContent = '🔊 Speak Info';
speakBtn.className = 'btn';
speakBtn.style.width = '100%';
speakBtn.style.marginBottom = '8px';
document.querySelector('.rightbox').insertBefore(speakBtn, document.querySelector('.rightbox').firstChild);

let lastElement = null;
function openModal(el) {
  lastElement = el;
  document.getElementById('mSym').textContent = el.sym;
  document.getElementById('mName').textContent = el.name;
  document.getElementById('mSub').textContent = `Atomic #${el.n} • ${CATMAP[el.cat] || el.cat}`;
  document.getElementById('mAbout').textContent = el.about || '—';
  document.getElementById('mMass').textContent = el.mass;
  document.getElementById('mConfig').textContent = el.config || '—';
  document.getElementById('mPG').textContent = `${el.period} / ${el.group}`;
  document.getElementById('mState').textContent = el.state || '—';
  document.getElementById('mQuick').textContent = `${el.sym} — ${el.name}`;
  document.getElementById('mCat').textContent = CATMAP[el.cat] || el.cat;
  if (!MODAL.open) MODAL.showModal();
}

speakBtn.onclick = function() {
  if (lastElement) speakElement(lastElement);
};
const CATMAP = { alkali:'Alkali metal', alkaline:'Alkaline earth metal', transition:'Transition metal', post:'Post-transition metal', metalloid:'Metalloid', poly:'Polyatomic nonmetal', diatomic:'Diatomic nonmetal', halogen:'Halogen', noble:'Noble gas', lanth:'Lanthanide', act:'Actinide', unknown:'Unknown' };

const TABLE = document.getElementById('table');
const TIP = document.getElementById('tooltip');
const SEARCH = document.getElementById('search');
const AUTOCOMPLETE = document.getElementById('autocomplete');
const MODAL = document.getElementById('modal');
const ZSLIDER = document.getElementById('zoomSlider');
const COMPACT = document.getElementById('compactBtn');
const RESET = document.getElementById('resetBtn');
const THEME = document.getElementById('themeToggle');

/* Helper to create a cell */
function createCell(el){
  const d = document.createElement('div');
  const cls = el.cat || 'unknown';
  d.className = 'cell ' + cls;
  let row = el.period; let col = el.group;
  if(el.cat==='lanth' && el.n!==57){ row=8; col=3+(el.n-57); }
  if(el.cat==='act' && el.n!==89){ row=9; col=3+(el.n-89); }
  d.style.gridRow = row; d.style.gridColumn = col;
  d.innerHTML = `<div class="atomic">${el.n}</div><div class="symbol">${el.sym}</div><div class="elname">${el.name}</div>`;

  d.addEventListener('mousemove',(ev)=>{
    TIP.innerHTML = `<strong style="font-size:14px">${el.sym}</strong> ${el.name}<br><span style="font-size:12px;color:#cce6ff">#${el.n} · ${el.mass}</span><br><span style="font-size:12px;color:#cce6ff">${CATMAP[el.cat]||el.cat}</span>`;
    TIP.style.left = (ev.clientX + 12) + 'px'; TIP.style.top = (ev.clientY + 12) + 'px'; TIP.classList.add('show');
  });
  d.addEventListener('mouseleave', ()=> TIP.classList.remove('show'));
  d.addEventListener('click', ()=> openModal(el));
  return d;
}

/* render entire table */
function render(elements=ELEMENTS){
  TABLE.innerHTML='';
  const f1=document.createElement('div'); f1.className='f-label'; f1.style.gridRow='8'; f1.textContent='Lanthanides'; TABLE.appendChild(f1);
  const f2=document.createElement('div'); f2.className='f-label'; f2.style.gridRow='9'; f2.textContent='Actinides'; TABLE.appendChild(f2);
  elements.forEach(el=> TABLE.appendChild(createCell(el)));
  // add ghost La/Ac duplicates
  const la = elements.find(x=>x.n===57); if(la){ const g=createCell(la); g.classList.add('ghost'); g.style.gridRow='8'; g.style.gridColumn='3'; TABLE.appendChild(g);} 
  const ac = elements.find(x=>x.n===89); if(ac){ const g2=createCell(ac); g2.classList.add('ghost'); g2.style.gridRow='9'; g2.style.gridColumn='3'; TABLE.appendChild(g2);} 
}

/* Modal */
function openModal(el){ document.getElementById('mSym').textContent=el.sym; document.getElementById('mName').textContent=el.name; document.getElementById('mSub').textContent=`Atomic #${el.n} • ${CATMAP[el.cat]||el.cat}`; document.getElementById('mAbout').textContent=el.about||'—'; document.getElementById('mMass').textContent=el.mass; document.getElementById('mConfig').textContent=el.config||'—'; document.getElementById('mPG').textContent=`${el.period} / ${el.group}`; document.getElementById('mState').textContent=el.state||'—'; document.getElementById('mQuick').textContent=`${el.sym} — ${el.name}`; document.getElementById('mCat').textContent=CATMAP[el.cat]||el.cat; if(!MODAL.open) MODAL.showModal(); }
document.getElementById('closeModal').addEventListener('click', ()=> MODAL.close());

/* Zoom slider controls */
ZSLIDER.addEventListener('input', (e)=>{ document.documentElement.style.setProperty('--cell-size', e.target.value + 'px'); });

/* Compact / Study toggle */
let isCompact=true;
COMPACT.addEventListener('click', ()=>{
  isCompact = !isCompact;
  if(isCompact){ COMPACT.textContent='Compact'; document.documentElement.style.setProperty('--cell-size','48px'); ZSLIDER.value=48; }
  else{ COMPACT.textContent='Study'; document.documentElement.style.setProperty('--cell-size','72px'); ZSLIDER.value=72; }
});

/* Theme toggle */
let dark=false; THEME.addEventListener('click', ()=>{ dark=!dark; document.body.classList.toggle('dark', dark); });

/* Reset */
RESET.addEventListener('click', ()=>{ SEARCH.value=''; document.documentElement.style.setProperty('--cell-size','48px'); ZSLIDER.value=48; COMPACT.textContent='Compact'; isCompact=true; render(); AUTOCLOSE(); });

/* Autocomplete */
const suggestions = document.createElement('div'); suggestions.style.position='absolute'; suggestions.style.top='36px'; suggestions.style.left='0'; suggestions.style.right='0'; suggestions.style.background='white'; suggestions.style.zIndex=40; suggestions.style.borderRadius='8px'; suggestions.style.boxShadow='0 10px 30px rgba(2,8,23,0.12)'; suggestions.style.display='none'; AUTOCOMPLETE.appendChild(suggestions);

function AUTOCLOSE(){ suggestions.style.display='none'; }

SEARCH.addEventListener('input', ()=>{
  const q = SEARCH.value.trim().toLowerCase(); if(!q){ AUTOCLOSE(); render(); return; }
  const matches = ELEMENTS.filter(e=> e.name.toLowerCase().includes(q) || e.sym.toLowerCase().includes(q) || String(e.n)===q).slice(0,8);
  suggestions.innerHTML='';
  if(matches.length===0){ AUTOCLOSE(); return; }
  matches.forEach(m=>{
    const it = document.createElement('div'); it.style.padding='8px 10px'; it.style.cursor='pointer'; it.style.borderBottom='1px solid rgba(2,8,23,0.03)'; it.innerHTML = `<strong>${m.sym}</strong> ${m.name} <span style="float:right;color:#6b7280">#${m.n}</span>`;
    it.addEventListener('click', ()=>{ openModal(m); AUTOCLOSE(); });
    suggestions.appendChild(it);
  });
  suggestions.style.display='block';
  // also highlight matches by rendering only them
  render(matches.concat([]));
});

document.addEventListener('click', (e)=>{ if(!AUTOCOMPLETE.contains(e.target) && e.target!==SEARCH) AUTOCLOSE(); });

/* Legend */
function buildLegend(){ const legend=document.getElementById('legend'); const keys=['alkali','alkaline','transition','post','metalloid','poly','diatomic','halogen','noble','lanth','act','unknown']; const labels={alkali:'Alkali metal',alkaline:'Alkaline earth metal',transition:'Transition metal',post:'Post-transition metal',metalloid:'Metalloid',poly:'Polyatomic nonmetal',diatomic:'Diatomic nonmetal',halogen:'Halogen',noble:'Noble gas',lanth:'Lanthanide',act:'Actinide',unknown:'Unknown'}; keys.forEach(k=>{ const el=document.createElement('div'); el.className='leg'; const sw=document.createElement('span'); sw.className='sw '+k; sw.style.background = window.getComputedStyle(document.documentElement).getPropertyValue('--'+k) || ''; el.appendChild(sw); const lab=document.createElement('div'); lab.textContent=labels[k]; el.appendChild(lab); legend.appendChild(el);}); }

render(ELEMENTS);
buildLegend();

// Ensure tooltip hides on resize/scroll
window.addEventListener('scroll', ()=> TIP.classList.remove('show'));
window.addEventListener('resize', ()=> TIP.classList.remove('show'));
</script>

</body>
</html>
